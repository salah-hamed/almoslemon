<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ø§Ù„Ù…Ø³Ù„Ù…ÙˆÙ† ÙŠØ°ÙƒØ±ÙˆÙ†</title>

  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@600;900&family=Scheherazade+New:wght@700&display=swap" rel="stylesheet">
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#2563eb" />

  <style>
    body {
      margin: 0;
      font-family: 'Cairo', 'Scheherazade New', sans-serif;
      background: linear-gradient(to bottom, #e0f2fe, #f9fafb);
      color: #111827;
      direction: rtl;
      text-align: center;
      transition: background 0.3s, color 0.3s;
    }
    body.dark { background: #0f172a; color: #f9fafb; }

    .header {
      background: #2563eb;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
    }
    .header-title {
      font-family: 'Scheherazade New', serif;
      font-size: 1.8rem;
      font-weight: bold;
    }
    .logo { display: flex; align-items: center; gap: 0.6rem; }
    .logo img { width: 40px; height: 40px; border-radius: 50%; }
    #toggle-dark {
      background: #fbbf24;
      color: #1e3a8a;
      border: none;
      border-radius: 2rem;
      padding: 0.4rem 1rem;
      font-size: 1rem;
      cursor: pointer;
    }
    #toggle-dark.dark { background: #334155; color: #fde047; }

    .slider-wrapper {
      position: relative;
      max-width: 500px;
      margin: 2rem auto 1rem auto;
      overflow: hidden;
      min-height: 430px;
    }
    .slide { display: none; width: 100%; }
    .slide.active { display: block; }

    .arrow-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: #2563ebbb;
      color: #fff;
      border: none;
      border-radius: 50%;
      font-size: 2.2rem;
      cursor: pointer;
      width: 2.6rem; height: 2.6rem;
      z-index: 5;
    }
    .arrow-left { right: 4px; }
    .arrow-right { left: 4px; }

    .counter {
      background: #fff;
      padding: 1.5rem;
      border-radius: 1.5rem;
      box-shadow: 0 4px 14px rgba(0,0,0,0.08);
      min-height: 340px;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
    }
    body.dark .counter { background: #1e2a3a; color: #eee; }

    .zikr-btn {
      background: linear-gradient(90deg, #fde68a, #fbbf24 90%);
      border: none;
      font-size: 1.45rem;
      font-weight: bold;
      padding: 1.1rem;
      width: 100%;
      border-radius: 1.1rem;
      color: #1e3a8a;
      cursor: pointer;
      margin-bottom: 0.6rem;
    }
    .zikr-btn .benefit { font-size: 1rem; display: block; color: #166534; margin-top: 0.5rem; }

    .count-display { font-size: 2.15rem; font-weight: bold; color: #10b981; margin: 1rem 0 0.5rem 0; }
    body.dark .count-display { color: #fbbf24; }
    .goal { font-size: 1rem; color: #666; margin-bottom: 0.7rem; }
    .total-display { font-size: 1.04rem; color: #1e3a8a; font-weight: 600; margin-bottom: 0.7rem; }
    body.dark .total-display { color: #fbbf24; }

    .share-btn {
      background: #3b82f6;
      color: #fff;
      border: none;
      border-radius: 2rem;
      padding: 0.6rem 1.4rem;
      font-size: 1rem;
      cursor: pointer;
      margin-top: 0.75rem;
    }

    .ads {
      max-width: 480px;
      margin: 2rem auto 0.7rem auto;
      text-align: center;
      font-size: 0.97rem;
      color: #555;
    }
    .ads .ad-note { font-weight: bold; color: #7c3aed; margin-bottom: 0.5rem; }

    .nav-links {
      text-align: center;
      margin: 2.3rem auto 1rem;
      font-size: 0.95rem;
    }
    .nav-links a { color: #2563eb; margin: 0 .5rem; text-decoration: none; }

    @media (max-width: 600px) {
      .counter, .slider-wrapper { max-width: 99vw; }
      .slide { min-height: 400px; }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="logo">
      <img src="icons/icon-192.png" alt="Ø³Ø¨Ø­Ø©" />
      <span class="header-title">Ø§Ù„Ù…Ø³Ù„Ù…ÙˆÙ† ÙŠØ°ÙƒØ±ÙˆÙ†</span>
    </div>
    <button id="toggle-dark">ğŸŒ™</button>
  </div>

  <div class="slider-wrapper">
    <button class="arrow-btn arrow-right" id="arrow-right" aria-label="Ø§Ù„ØªØ§Ù„ÙŠ">âŸ©</button>
    <button class="arrow-btn arrow-left" id="arrow-left" aria-label="Ø§Ù„Ø³Ø§Ø¨Ù‚">âŸ¨</button>
    <div id="slides"></div>
  </div>

  <div class="ads">
    <div class="ad-note">Ø¥Ø¹Ù„Ø§Ù†Ø§ØªÙ†Ø§ ÙˆØ³ÙŠÙ„Ø© Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ø¬Ø§Ù†Ù‹Ø§ ğŸ¤</div>
    <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="ca-pub-1234567890123456"
      data-ad-slot="1234567890"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins>
  </div>

  <div class="nav-links">
    <a href="about.html">Ù…Ù† Ù†Ø­Ù†</a> |
    <a href="privacy.html">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a>
  </div>

  <!-- Firebase compat -->
  <script src="https://www.gstatic.com/firebasejs/9.21.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.21.0/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDAtBO4QsCqu-7bvhd9gkyCRZjmKhdBG7E",
      authDomain: "el-muslim-914e3.firebaseapp.com",
      projectId: "el-muslim-914e3",
      storageBucket: "el-muslim-914e3.appspot.com",
      messagingSenderId: "657227709357",
      appId: "1:657227709357:web:82b5b7b3b2da9afebdbf24"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const today = new Date().toISOString().split("T")[0];
    const uid = localStorage.getItem("uid") || (() => {
      const id = "user_" + Math.random().toString().slice(2,10);
      localStorage.setItem("uid", id);
      return id;
    })();

    const azkar = [
      { key: 'zikr_nabi',     text: 'Ø§Ù„ØµÙ„Ø§Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ ï·º', benefit: 'âœ¦ Ø´ÙØ§Ø¹Ø© ÙˆØ±Ø­Ù…Ø© Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡' },
      { key: 'zikr_subhan',   text: 'Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡ âœ¨',       benefit: 'âœ¦ Ù…Ù† Ø£Ø­Ø¨ Ø§Ù„ÙƒÙ„Ø§Ù… Ø¥Ù„Ù‰ Ø§Ù„Ù„Ù‡' },
      { key: 'zikr_hamd',     text: 'Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ ğŸ™',        benefit: 'âœ¦ ØªÙ…Ù„Ø£ Ø§Ù„Ù…ÙŠØ²Ø§Ù†' },
      { key: 'zikr_la',       text: 'Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡ ğŸ•Šï¸',  benefit: 'âœ¦ Ø£Ø¹Ø¸Ù… Ø§Ù„Ø°ÙƒØ± ÙˆÙ…ÙØªØ§Ø­ Ø§Ù„Ø¬Ù†Ø©' },
      { key: 'zikr_akbar',    text: 'Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø± ğŸŒŸ',        benefit: 'âœ¦ Ø£Ø¹Ø¸Ù… Ù…Ù† ÙƒÙ„ Ø´ÙŠØ¡' },
      { key: 'zikr_astaghfir',text: 'Ø§Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡ ğŸ¤',      benefit: 'âœ¦ ÙŠÙ…Ù†Ø­Ùƒ Ø±Ø§Ø­Ø© ÙˆØ³Ø¹Ø© ÙÙŠ Ø§Ù„Ø±Ø²Ù‚' }
    ];

    const slidesDiv = document.getElementById('slides');

    azkar.forEach(({key, text, benefit}) => {
      const logs = JSON.parse(localStorage.getItem(key + "_logs") || "{}");
      let count = logs[today] || 0;
      let total = parseInt(localStorage.getItem(key + "_total") || '0', 10);

      const slide = document.createElement("div");
      slide.className = "slide";

      const box = document.createElement("div");
      box.className = "counter";

      const btn = document.createElement("button");
      btn.className = "zikr-btn";
      btn.innerHTML = `<span>${text}</span><span class="benefit">${benefit}</span>`;

      const countEl = document.createElement("div");
      countEl.className = "count-display";
      countEl.textContent = count;

      const goalEl = document.createElement("div");
      goalEl.className = "goal";
      goalEl.textContent = count >= 100 ? "âœ… ØªÙ… Ø¨Ù„ÙˆØº Ø§Ù„Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…ÙŠ!" : "ğŸ¯ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…ÙŠ: 100";

      const totalEl = document.createElement("div");
      totalEl.className = "total-display";
      totalEl.textContent = `ğŸ“ˆ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total}`;

      const shareBtn = document.createElement("button");
      shareBtn.className = "share-btn";
      shareBtn.textContent = "Ø´Ø§Ø±ÙƒÙ†ÙŠ Ø§Ù„Ø£Ø¬Ø±";

      btn.onclick = () => {
        count++;
        logs[today] = count;
        localStorage.setItem(key + "_logs", JSON.stringify(logs));
        total++;
        localStorage.setItem(key + "_total", total);
        countEl.textContent = count;
        totalEl.textContent = `ğŸ“ˆ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total}`;
        goalEl.textContent = count >= 100 ? "âœ… ØªÙ… Ø¨Ù„ÙˆØº Ø§Ù„Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…ÙŠ!" : "ğŸ¯ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…ÙŠ: 100";
        try {
          new Audio('https://cdn.pixabay.com/audio/2022/10/16/audio_12b2548572.mp3').play();
        } catch(e){}
        db.collection("daily_azkar").doc(uid + "_" + today)
          .set({ [key]: count }, { merge: true });
      };

      shareBtn.onclick = () => {
        const msg = `Ø°ÙƒØ±Øª ${count} Ã— "${text}" Ø§Ù„ÙŠÙˆÙ… ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø³Ù„Ù…ÙˆÙ† ÙŠØ°ÙƒØ±ÙˆÙ†.
${benefit}`;
        if (navigator.share) {
          navigator.share({ title: "Ø§Ù„Ù…Ø³Ù„Ù…ÙˆÙ† ÙŠØ°ÙƒØ±ÙˆÙ†", text: msg, url: location.href });
        } else {
          navigator.clipboard.writeText(msg + "
" + location.href);
          alert("ğŸ“‹ ØªÙ… Ù†Ø³Ø® Ù†Øµ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©.");
        }
      };

      box.appendChild(btn);
      box.appendChild(countEl);
      box.appendChild(goalEl);
      box.appendChild(totalEl);
      box.appendChild(shareBtn);
      slide.appendChild(box);
      slidesDiv.appendChild(slide);
    });

    // slider controls
    let current = 0;
    const allSlides = document.querySelectorAll('.slide');
    function showSlide(idx) {
      if (idx < 0) idx = 0;
      if (idx >= allSlides.length) idx = allSlides.length - 1;
      current = idx;
      allSlides.forEach((el,i)=> el.classList.toggle('active', i===current));
    }
    showSlide(0);
    document.getElementById('arrow-right').onclick = () => showSlide(current + 1);
    document.getElementById('arrow-left').onclick  = () => showSlide(current - 1);

    // touch swipe
    let startX = null;
    slidesDiv.addEventListener('touchstart', e => { startX = e.touches[0].clientX; });
    slidesDiv.addEventListener('touchend', e => {
      if (startX == null) return;
      const dx = e.changedTouches[0].clientX - startX;
      if (Math.abs(dx) > 40) {
        if (dx < 0) showSlide(current + 1);
        if (dx > 0) showSlide(current - 1);
      }
      startX = null;
    });

    // dark mode
    const toggle = document.getElementById("toggle-dark");
    toggle.onclick = () => {
      const isDark = !document.body.classList.contains("dark");
      document.body.classList.toggle("dark", isDark);
      toggle.classList.toggle("dark", isDark);
      toggle.textContent = isDark ? "â˜€ï¸" : "ğŸŒ™";
      localStorage.setItem("darkMode", isDark ? "on" : "off");
    };
    if (localStorage.getItem("darkMode") === "on") {
      document.body.classList.add("dark");
      toggle.classList.add("dark");
      toggle.textContent = "â˜€ï¸";
    }

    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('service-worker.js');
      });
    }
  </script>
</body>
</html>
